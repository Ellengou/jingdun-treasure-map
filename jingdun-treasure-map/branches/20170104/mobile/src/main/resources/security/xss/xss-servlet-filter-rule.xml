<?xml version="1.0" encoding="UTF-8"?>
<config xmlns="http://www.navercorp.com/lucy-xss-servlet">
    <defenders>
        <!-- XssPreventer  过滤规则：粗暴转义。StringEscapeUtils.escapeHtml4(clean) ; -->
        <defender>
            <name>xssPreventerDefender</name>
            <class>com.jd.core.filter.XssPreventerDefender</class>
        </defender>
        <!-- XssScanitizerFilterDefender 过滤规则：清理xss内容。 XssSanitizerUtil.stripXSS(value)  -->
        <defender>
            <name>xssScanitizerFilterDefender</name>
            <class>com.jd.core.filter.XssScanitizerFilterDefender</class>
        </defender>
        <!-- xssJSONPreventerDefender 过滤规则：清理xss内容。new HTMLFilter(false).jsonFilter(value) json value 转义  -->
        <defender>
            <name>xssJSONPreventerDefender</name>
            <class>com.jd.core.filter.XssJSONPreventerDefender</class>
        </defender>
        <!-- xssJSONPreventerDefender 过滤规则：清理xss内容。将String前后的空格去除  -->
        <defender>
            <name>xssStringTrimDefender</name>
            <class>com.jd.core.filter.XssStringTrimDefender</class>
        </defender>
    </defenders>

    <!-- default defender 默认的xss处理 -->
    <default>
        <defender>xssPreventerDefender</defender>
    </default>

    <!-- global   -->
    <global>
        <params>
            <param name="globalParameter" usePrefix="true" useDefender="false"/>
            <!-- 拦截所有的@RequestBody json数据 -->
            <param name="requestBody" usePrefix="false" useDefender="true">
                <defender>xssJSONPreventerDefender</defender>
            </param>
        </params>
    </global>
    <!-- url  -->
    <url-rule-set>
        <!-- params 匹配请求参数， useDefender=false 启用过滤  -->
        <!-- url 匹配路由 -->
        <url-rule>
            <url disable="false">/wap/session</url>
        </url-rule>
        <url-rule>
            <url disable="false">/image/code</url>
        </url-rule>
        <!-- 富文本 <javascript>**</javascript> 等含有xss攻击的直接剔除  -->
        <url-rule><!-- 評價 -->
            <url disable="true">/wap/item/eval</url>
            <params>
                <param name="memo" useDefender="true">
                    <defender>xssScanitizerFilterDefender</defender>
                </param>
                <param name="content" useDefender="true">
                    <defender>xssScanitizerFilterDefender</defender>
                </param>
            </params>
        </url-rule>

        <!-- 默认全部拦截   过滤规则xssPreventerDefender-->
        <url-rule>
            <url disable="true">/**</url>
        </url-rule>

    </url-rule-set>
</config>